
# Real-time Portfolio Metrics

## Why
The `/portfolio` page currently relies on `polyClient` to fetch on-chain wallet data. This causes "Simulated/Copy Trading" data (stored locally) to be invisible, preventing users from tracking their investment progress during simulations.

## What Changes
We implement a hybrid data layer for the Portfolio page that fetches metrics from the local database alongside on-chain data.

## Problem
The `/portfolio` page currently relies on `polyClient` to fetch on-chain wallet data. This causes two issues:
1. **Simulation Invisibility:** Data generated by the `simulate-copy-trading.ts` script (stored in the local PostgreSQL database) is not visible on the UI, as the frontend queries the blockchain instead of the local DB.
2. **Missing Metrics:** Users cannot see their "Invested Funds" (total capital currently deployed in copy trading) or real-time PnL updates for these active strategies.

## Solution
We will implement a hybrid data layer for the Portfolio page that:
1. Fetches "Simulated/Copy Trading" metrics directly from the local database (`UserPosition` and `CopyTrade` tables).
2. Displays "Invested Funds" and "Profit/Loss" derived from this local data.
3. Updates these metrics in real-time (polling or event-based) to reflect simulation progress.

## Scope
- **Backend API:** Create endpoints to aggregate `UserPosition` and `CopyTrade` data into financial metrics (Invested, PnL).
- **Frontend UI:** 
    - Add a new "Invested Funds" metric card (or update existing ones).
    - Update the "Profit/Loss" card to reflect local copy trading performance.
    - Ensure the "Positions" tab includes simulated positions from the DB.
